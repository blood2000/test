(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/waybillScan/receive"],{"814d":function(e,t,o){"use strict";var a=o("89d3"),n=o.n(a);n.a},"89d3":function(e,t,o){},9920:function(e,t,o){"use strict";(function(e){o("a54f");a(o("66fd"));var t=a(o("a431"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"9af0":function(e,t,o){"use strict";o.r(t);var a=o("e826"),n=o.n(a);for(var i in a)"default"!==i&&function(e){o.d(t,e,(function(){return a[e]}))}(i);t["default"]=n.a},a431:function(e,t,o){"use strict";o.r(t);var a=o("cc1b"),n=o("9af0");for(var i in n)"default"!==i&&function(e){o.d(t,e,(function(){return n[e]}))}(i);o("814d");var r,s=o("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,"a4e16a24",null,!1,a["a"],r);t["default"]=c.exports},cc1b:function(e,t,o){"use strict";var a;o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return a}));var n=function(){var e=this,t=e.$createElement;e._self._c},i=[]},e826:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o("e648");function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var s={props:{scanInfo:{type:Object,default:function(){return{}}},show:{type:Boolean,default:!1}},data:function(){return{modalName:null,licenseNumber:"",teamName:"",imgList:[],carriageInfo:{},driverInfo:{},form:{},teamContract:!1,transContract:!0,unit:""}},watch:{show:{handler:function(t){t&&(e.showLoading({mask:!0}),this.reset(),this.getCarriage())},immediate:!0}},methods:{getCarriage:function(){var t=this;(0,a.getCarriageInfo)(this.scanInfo.orderCode).then((function(o){t.carriageInfo=o.data,t.licenseNumber=t.carriageInfo.vehicleInfos[0].licenseNumber,t.carriageInfo.teamInfos.length>0&&(t.teamName=t.carriageInfo.teamInfos[0].name,t.form.dispatcherCode=o.data.teamInfos[0].code),"0"===o.data.stowageStatus?t.unit="吨":"1"===o.data.stowageStatus?t.unit="方":"2"===o.data.stowageStatus&&(t.unit="车"),t.form=i(i({},t.form),{},{orderCode:t.scanInfo.orderCode,goodsCode:o.data.orderGoods[0].code,vehicleCode:o.data.vehicleInfos[0].vehicleCode,loadAddressCode:o.data.orderAddresses[0].code,unloadAddressCode:o.data.orderAddresses[1].code,loadUnloadType:o.data.loadType}),e.hideLoading()}))},showModal:function(e){this.modalName=e.currentTarget.dataset.target},hideModal:function(e){this.modalName=null},RadioChange:function(e){console.log(e),this.form.vehicleCode=e.detail.value;var t=this.carriageInfo.vehicleInfos.find((function(t){return t.vehicleCode===e.detail.value}));this.licenseNumber=t.licenseNumber,this.hideModal()},teamRadioChange:function(e){console.log(e),this.form.dispatcherCode=e.detail.value;var t=this.carriageInfo.teamInfos.find((function(t){return t.code===e.detail.value}));this.teamName=t.name,this.hideModal()},teamTap:function(){this.teamContract=!this.teamContract},teamTapTrue:function(){this.teamContract=!0},teamTapFalse:function(){this.teamContract=!1},navToCollection:function(){e.navigateTo({url:"/pages/protocol/collection?driverCode="+this.carriageInfo.driverCode+"&teamCode="+this.form.dispatcherCode})},navToContract:function(){e.navigateTo({url:"/pages/protocol/contractDriver?code="+this.form.orderCode+"&licenseNumber="+this.licenseNumber})},transTap:function(){this.transContract=!this.transContract},ChooseImage:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album"],success:function(o){for(var a=0;a<o.tempFiles.length;a++)o.tempFiles[a].size/1024/1024>5?e.showToast({title:"第"+a+"1张图片大小超过5M",icon:"none"}):t.uploadImage(o.tempFiles[a].path)}})},uploadImage:function(t){var o=this;e.showLoading({mask:!0}),e.uploadFile({url:a.uploadImgApi,filePath:t,name:"file",formData:{file:t},header:{"Content-Type":"multipart/form-data","Produce-Code":"776ca8e240574192b6e0f69b417163df","App-Code":"9d3017728cb34eac947ba350c4e997be","App-Type":"2","App-Version":"2.0",Authorization:e.getStorageSync("token"),"Terminal-Type":"app"},success:function(t){var a=JSON.parse(t.data);o.imgList.push(a.data),e.hideLoading()},fail:function(t){e.hideLoading(),e.showModal({title:"错误提示",content:"上传图片失败",showCancel:!1,success:function(e){}})}})},ViewImage:function(t){var o=this.imgList.map((function(e){return e.path}));e.previewImage({urls:o,current:t.currentTarget.dataset.url})},DelImg:function(t){var o=this;e.showModal({title:"确认删除",content:"确定要删除这张凭证吗？",cancelText:"取消",confirmText:"删除",success:function(e){e.confirm&&o.imgList.splice(t.currentTarget.dataset.index,1)}})},numMath:function(e){var t=e.detail.value-0;"2"===this.carriageInfo.stowageStatus?this.form.weight=t.toFixed(0):this.form.weight=t.toFixed(3)},reset:function(){this.form={orderCode:void 0,goodsCode:void 0,vehicleCode:void 0,weight:void 0,operatorTime:void 0,remark:void 0,attachmentCodes:[],dispatcherCode:void 0,dregsRecevieAndLoad:1,loadAddressCode:void 0,unloadAddressCode:void 0,loadUnloadType:void 0}},navBack:function(){e.navigateBack({})},submit:function(){var t=this;this.form.attachmentCodes=this.imgList.map((function(e){return e.path})),this.form.operatorTime=this.parseTime(new Date,"{y}-{m}-{d} {h}:{i}:{s}"),console.log(this.form),this.form.weight<=0||!this.form.weight?e.showToast({title:"装货数量必须大于0且不为空",icon:"none",duration:2e3}):this.form.vehicleCode?this.transContract?0===this.carriageInfo.reviewIsNeedLoadingCertificate&&this.form.attachmentCodes.length<1?e.showToast({title:"请上传装货凭证",icon:"none",duration:2e3}):this.carriageInfo.teamInfos.length>0&&!this.teamContract?e.showToast({title:"请勾选加入调度须知",icon:"none",duration:2e3}):(e.showLoading({mask:!0}),(0,a.appReceiveAndLoadOrder)(this.form).then((function(o){t.modalName="warning",e.hideLoading()}))):e.showToast({title:"请选择先阅读运输合同",icon:"none",duration:2e3}):e.showToast({title:"请选择承运车辆",icon:"none",duration:2e3})}}};t.default=s}).call(this,o("543d")["default"])}},[["9920","common/runtime","common/vendor"]]]);