(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/waybillScan/load"],{1005:function(e,t,a){"use strict";a.r(t);var o=a("4192"),n=a("4f98");for(var i in n)"default"!==i&&function(e){a.d(t,e,(function(){return n[e]}))}(i);a("c8e9");var r,s=a("f0c5"),c=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"7b25a232",null,!1,o["a"],r);t["default"]=c.exports},1351:function(e,t,a){},4192:function(e,t,a){"use strict";var o;a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return o}));var n=function(){var e=this,t=e.$createElement,a=(e._self._c,e.parseTime(e.form.operatorTime,"{y}-{m}-{d} {h}:{i}")||"-");e.$mp.data=Object.assign({},{$root:{m0:a}})},i=[]},"4f98":function(e,t,a){"use strict";a.r(t);var o=a("5d7a"),n=a.n(o);for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);t["default"]=n.a},"5d7a":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a("e648");n(a("9e79"));function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){s(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c={props:{scanInfo:{type:Object,default:function(){return{}}},show:{type:Boolean,default:!1}},data:function(){return{textareaNum:0,imgList:[],waybillInfo:{},form:{},needImg:!1,unit:"",modalName:null}},watch:{show:{handler:function(t){t&&(e.showLoading({mask:!0}),this.reset(),this.getWaybill())},immediate:!0}},methods:{getWaybill:function(){var t=this;(0,o.getWaybillInfo)(this.scanInfo.waybillCode).then((function(a){t.waybillInfo=a.data,t.form=r(r({},t.form),{},{orderCode:a.data.orderCode,goodsCode:a.data.goodsCode,waybillCode:a.data.waybillCode,vehicleCode:a.data.vehicleCode,operatorTime:t.parseTime(new Date,"{y}-{m}-{d} {h}:{i}:{s}")}),"0"===a.data.stowageStatus?t.unit="吨":"1"===a.data.stowageStatus?t.unit="方":"2"===a.data.stowageStatus&&(t.unit="车"),0==a.data.reviewIsNeedLoadingCertificate?t.needImg=!0:t.needImg=!1,e.hideLoading()}))},textareaInput:function(e){this.textareaNum=e.detail.value.length},ChooseImage:function(){var t=this;e.chooseImage({count:9,sizeType:["original","compressed"],sourceType:["album"],success:function(a){for(var o=0;o<a.tempFiles.length;o++)a.tempFiles[o].size/1024/1024>5?e.showToast({title:"第"+o+"1张图片大小超过5M",icon:"none"}):t.uploadImage(a.tempFiles[o].path)}})},uploadImage:function(t){var a=this;e.showLoading({mask:!0}),e.uploadFile({url:o.uploadImgApi,filePath:t,name:"file",formData:{file:t},header:{"Content-Type":"multipart/form-data","Produce-Code":"776ca8e240574192b6e0f69b417163df","App-Code":"9d3017728cb34eac947ba350c4e997be","App-Type":"2","App-Version":"2.0",Authorization:e.getStorageSync("token"),"Terminal-Type":"app"},success:function(t){var o=JSON.parse(t.data);a.imgList.push(o.data),e.hideLoading()},fail:function(t){e.hideLoading(),e.showModal({title:"错误提示",content:"上传图片失败",showCancel:!1,success:function(e){}})}})},ViewImage:function(t){var a=this.imgList.map((function(e){return e.path}));e.previewImage({urls:a,current:t.currentTarget.dataset.url})},DelImg:function(t){var a=this;e.showModal({title:"确认删除",content:"确定要删除这张凭证吗？",cancelText:"取消",confirmText:"删除",success:function(e){e.confirm&&a.imgList.splice(t.currentTarget.dataset.index,1)}})},numMath:function(e){var t=e.detail.value-0;"2"===this.waybillInfo.stowageStatus?this.form.weight=t.toFixed(0):this.form.weight=t.toFixed(3)},submit:function(){var t=this;this.form.attachmentCodes=this.imgList.map((function(e){return e.path})),0===this.waybillInfo.reviewIsNeedLoadingCertificate&&(!this.form.weight||this.form.weight<=0)?e.showToast({title:"请输入装货重量",icon:"none",duration:2e3}):0===this.waybillInfo.reviewIsNeedLoadingCertificate&&this.form.attachmentCodes.length<1?e.showToast({title:"请上传卸货凭证",icon:"none",duration:2e3}):(e.showLoading({mask:!0}),(0,o.appLoadOrder)(this.form).then((function(a){t.modalName="warning",e.hideLoading()})))},reset:function(){this.form={orderCode:void 0,goodsCode:void 0,waybillCode:void 0,vehicleCode:void 0,weight:void 0,operatorTime:void 0,remark:void 0,attachmentCodes:[]}}}};t.default=c}).call(this,a("543d")["default"])},"7dbe":function(e,t,a){"use strict";(function(e){a("a54f");o(a("66fd"));var t=o(a("1005"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,a("543d")["createPage"])},c8e9:function(e,t,a){"use strict";var o=a("1351"),n=a.n(o);n.a}},[["7dbe","common/runtime","common/vendor"]]]);