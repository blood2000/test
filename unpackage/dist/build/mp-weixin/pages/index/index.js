(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"0c79":function(e,n,t){"use strict";t.r(n);var i=t("4264"),a=t("be92");for(var o in a)"default"!==o&&function(e){t.d(n,e,(function(){return a[e]}))}(o);t("59e2"),t("5a30");var c,s=t("f0c5"),d=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"762b3b19",null,!1,i["a"],c);n["default"]=d.exports},4264:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return i}));var i={uniDataCheckbox:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox")]).then(t.bind(null,"f7c2"))}},a=function(){var e=this,n=e.$createElement;e._self._c},o=[]},4375:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=t("c839"),a=t("f43f"),o={components:{},data:function(){return{scanData:{operatorMsg:"",Msg:""},deviceCode:null,scanErr:!1,modalName:null,deviceInfo:{},licenseNumber:null,isBind:!1,vehicleParams:{pageNum:1,pageSize:10,authStatus:3,isFreeze:0,licenseNumber:null},dataOver:!1,bindParams:{deviceCode:null,vehicleCode:null,vendorCode:"jimilot"},vehicleList:[],debounceFun:void 0}},onLoad:function(e){var n=this;if(this.debounceFun=(0,a.DebounceFun)(this.searchVehicle,300),e.code)this.bindParams.deviceCode=e.code;else{var t=decodeURIComponent(e.q).split("/");this.bindParams.deviceCode=t[t.length-1]}"undefined"!==this.bindParams.deviceCode?this.wxlogin((function(e){0===e?(n.scanData.operatorMsg="对不起，您不是平台用户，无法使用该功能，如有疑问，请联系客服人员。",n.modalName="warning"):3===e?(n.scanData.operatorMsg="对不起，我们暂未给司机用户提供该功能，可以联系您的车队管理者，如还有其他疑问，请联系客服人员。",n.modalName="warning"):n.getInfo()})):(this.scanData.operatorMsg="请使用微信扫一扫，扫描设备二维码，方可进入小程序。",this.modalName="warning")},onShow:function(){var n=this;e.getStorageSync("token")||(this.scanData.operatorMsg="授权登录失败，请重新扫描设备二维码，进入小程序。",this.modalName="warning"),e.$on("handClick",(function(t){0===t?(n.scanData.operatorMsg="对不起，您不是平台用户，无法使用该功能，如有疑问，请联系客服人员。",n.modalName="warning"):3===t?(n.scanData.operatorMsg="对不起，我们暂未给司机用户提供该功能，可以联系您的车队管理者，如还有其他疑问，请联系客服人员。",n.modalName="warning"):n.getInfo(),e.$off("handClick")}))},methods:{showModal:function(e){this.isBind||(this.modalName=e.currentTarget.dataset.target)},hideModal:function(e){this.modalName=null},searchVehicle:function(){this.vehicleParams.pageNum=1,this.dataOver=!1,this.getVehicle(0)},getInfo:function(){var e=this;this.modalName=null,(0,i.getDevice)(this.bindParams.deviceCode).then((function(n){n.data.licenseNumber?(e.isBind=!0,e.licenseNumber=n.data.licenseNumber):(e.isBind=!1,e.licenseNumber=null),e.deviceInfo=n.data}))},getVehicle:function(e){var n=this;(0,i.getVehicleList)(this.vehicleParams).then((function(t){n.dataOver=!t.rows.length;var i=t.rows.map((function(e){return{text:e.licenseNumber,value:e.code}}));0===e&&(n.vehicleList=[]),n.vehicleList=n.vehicleList.concat(i)}))},scrolltolower:function(){this.dataOver||(this.vehicleParams.pageNum++,this.getVehicle(1))},vehicleChange:function(e){this.licenseNumber=e.detail.data.text,this.modalName=null},binding:function(){var n=this;this.bindParams.vehicleCode?(0,i.bindDevice)(this.bindParams).then((function(t){e.showToast({title:"绑定成功",icon:"none",duration:2e3}),setTimeout((function(){e.redirectTo({url:"/pages/index/index?code="+n.bindParams.deviceCode})}),1e3)})):e.showToast({title:"请选择车辆",icon:"none"})},unbound:function(){var n=this;(0,i.delByDevice)({vehicleCode:this.deviceInfo.vehicleCode,deviceCode:this.deviceInfo.deviceCode}).then((function(t){e.showToast({title:"解绑成功",icon:"none",duration:2e3}),setTimeout((function(){e.redirectTo({url:"/pages/index/index?code="+n.bindParams.deviceCode})}),1e3)}))}}};n.default=o}).call(this,t("543d")["default"])},"59e2":function(e,n,t){"use strict";var i=t("fb23"),a=t.n(i);a.a},"5a30":function(e,n,t){"use strict";var i=t("957a"),a=t.n(i);a.a},"957a":function(e,n,t){},be92:function(e,n,t){"use strict";t.r(n);var i=t("4375"),a=t.n(i);for(var o in i)"default"!==o&&function(e){t.d(n,e,(function(){return i[e]}))}(o);n["default"]=a.a},ca5d:function(e,n,t){"use strict";(function(e){t("a54f");i(t("66fd"));var n=i(t("0c79"));function i(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},fb23:function(e,n,t){}},[["ca5d","common/runtime","common/vendor"]]]);